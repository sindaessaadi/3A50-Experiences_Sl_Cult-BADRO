{% extends 'base.html.twig' %}

{% block body %}
    <style>
        /* Table Style */
        .table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }

        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            vertical-align: middle;
        }

        

        .table td {
            background-color: #f8f9fa;
            border-top: 1px solid #ddd;
        }

        /* Hover effect for rows */
        .table-hover tbody tr:hover {
            background-color: #f1f1f1;
        }

        /* Adjust action column to have better width */
        .table th:last-child, .table td:last-child {
            width: 250px; /* Adjusted for a wider action column */
            text-align: center;
        }

        /* Buttons Styling */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            gap: 5px;
        }

        .action-buttons a, .action-buttons button {
            padding: 6px 12px; 
            font-size: 14px;
            width: auto;
            min-width: 80px; 
        }

        .action-buttons button {
            cursor: pointer;
        }

        /* For small screen responsiveness */
        @media (max-width: 768px) {
            .table th:last-child,
            .table td:last-child {
                width: 200px; 
            }

            .action-buttons {
                flex-direction: column; 
            }
        }
    </style>

    <h1 class="event-title">Event List</h1>

    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>Id</th>
                <th>Title</th>
                <th>Description</th>
                <th>Date</th>
                <th>Time</th>
                <th>Location</th>
                <th>Type</th>
                <th>Organizer</th>
                <th>Max Participants</th>
                <th>Status</th>
                <th>Ticket Price</th>
                <th>Inscription Deadline</th>
                <th>Actions</th> <!-- Adjusted column width in CSS -->
            </tr>
        </thead>
        <tbody>
        {% for evenement in evenements %}
            <tr>
                <td>{{ evenement.id }}</td>
                <td>{{ evenement.titre }}</td>
                <td>{{ evenement.description }}</td>
                <td>{{ evenement.date ? evenement.date|date('Y-m-d') : 'N/A' }}</td>
                <td>{{ evenement.heure ? evenement.heure|date('H:i') : 'N/A' }}</td>
                <td>{{ evenement.lieu }}</td>
                <td>{{ evenement.type }}</td>
                <td>{{ evenement.organisateurNom }}</td>
                <td>{{ evenement.nombreMaxParticipants }}</td>
                <td>
                    {% if evenement.status == 'Active' %}
                        <span class="badge bg-success">Active</span>
                    {% else %}
                        <span class="badge bg-secondary">Inactive</span>
                    {% endif %}
                </td>
                <td>{{ evenement.ticketPrix }} TND</td>
                <td>{{ evenement.periodeInscriptionFin ? evenement.periodeInscriptionFin|date('Y-m-d') : 'N/A' }}</td>
                <td>
                    <div class="action-buttons">
                        <a href="{{ path('app_evenement_show', {'id': evenement.id}) }}" class="btn btn-primary btn-sm">View</a>
                        <a href="{{ path('app_evenement_edit', {'id': evenement.id}) }}" class="btn btn-secondary btn-sm">Edit</a>

                        

                         <form action="{{ path('app_evenement_delete', {'id': evenement.id}) }}" method="post" onsubmit="return confirm('Are you sure you want to delete this event?');" style="display:inline;">
                         <input type="hidden" name="_method" value="DELETE">  <!-- This makes sure the delete request is sent -->
                         <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ evenement.id) }}">  <!-- CSRF token for security -->
                         <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                         </form>
                    </div>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="13" class="text-center text-muted">No events found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <div class="text-center mt-4">
        <a href="{{ path('app_evenement_new') }}" class="btn btn-success">Create New Event</a>
    </div>

{% endblock %}
